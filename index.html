<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<title>KYXZANTZY OFFICIAL AUTOMATIC CPANEL</title>
<script src="https://cdn.tailwindcss.com"></script>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet"/>
<style>
  body { background: linear-gradient(to bottom right, #0f172a, #1e1b4b, #312e81); color: white; font-family: 'Inter', sans-serif; }
</style>
</head>
<body class="bg-gray-950 min-h-screen flex flex-col">
  <!-- Login Overlay -->
  <div class="fixed inset-0 bg-black bg-opacity-80 z-50 flex items-center justify-center" id="loginOverlay">
    <div class="bg-gray-900 p-6 rounded-lg shadow-lg w-full max-w-sm border border-white/10">
      <h2 class="text-2xl font-semibold text-center text-indigo-400 mb-4">Login Your Panel</h2>
      <input id="loginUser" placeholder="Username" type="text" class="w-full mb-3 px-4 py-2 border border-white/20 bg-white/10 text-white placeholder-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-indigo-400"/>
      <input id="loginPass" placeholder="Password" type="password" class="w-full mb-3 px-4 py-2 border border-white/20 bg-white/10 text-white placeholder-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-indigo-400"/>
      <label class="text-sm text-gray-300 flex items-center mt-2 space-x-2">
        <input type="checkbox" onclick="togglePassword()" class="accent-indigo-500 rounded-xl"><span>Tampilkan Password</span>
      </label>
      <button onclick="doLogin()" class="w-full bg-indigo-600 text-white py-2 rounded-xl hover:bg-indigo-700 transition mt-4">Login</button>
      <p id="loginError" class="text-red-400 text-center mt-3 hidden">Login gagal. Username atau password salah.</p>
    </div>
  </div>

  <!-- Dashboard Menu -->
  <main id="dashboardMenu" class="flex-grow flex flex-col items-center justify-center min-h-screen hidden">
    <div class="w-full max-w-md p-6 rounded-2xl bg-gray-900 shadow-2xl">
      <h2 class="text-xl font-bold mb-6 text-indigo-300 text-center flex items-center gap-2">
        <svg xmlns="http://www.w3.org/2000/svg" class="w-7 h-7 text-indigo-400 inline-block mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-width="2" d="M3 10h3m0 0V7a4 4 0 014-4h4a4 4 0 014 4v3m-12 0v10a2 2 0 002 2h8a2 2 0 002-2V10m-12 0h12"/></svg>Available Feature
      </h2>
      <div class="grid grid-cols-1 gap-4">
        <div onclick="showAdminPanel()" class="flex items-center gap-3 p-4 rounded-xl bg-gray-800 hover:bg-indigo-900 cursor-pointer transition">
          <svg class="w-7 h-7 text-sky-400" fill="currentColor" viewBox="0 0 20 20"><path d="M18 8a6 6 0 11-12 0 6 6 0 0112 0zM2 16a8 8 0 1116 0v1a1 1 0 01-1 1H3a1 1 0 01-1-1v-1z"/></svg>
          <div><div class="font-semibold text-lg">Admin Panel</div><div class="text-gray-300 text-sm">Create Admin Panel</div></div>
        </div>
        <div onclick="showPanel()" class="flex items-center gap-3 p-4 rounded-xl bg-gray-800 hover:bg-indigo-900 cursor-pointer transition">
          <svg class="w-7 h-7 text-cyan-400" fill="currentColor" viewBox="0 0 20 20"><path d="M10 2a8 8 0 100 16 8 8 0 000-16zm1 13H9v-2h2v2zm0-4H9V7h2v4z"/></svg>
          <div><div class="font-semibold text-lg">Panel</div><div class="text-gray-300 text-sm">Create Server Panel</div></div>
        </div>
      </div>
    </div>
  </main>

  <!-- Admin Panel Modal -->
  <div id="adminPanelModal" class="fixed inset-0 bg-black bg-opacity-80 z-50 flex items-center justify-center hidden">
    <div class="bg-gray-900 p-6 rounded-xl shadow-xl w-full max-w-sm">
      <h3 class="text-lg font-semibold text-indigo-400 mb-4 text-center">Create Admin Panel</h3>
      <input id="adminNameInput" placeholder="Admin Name/Username" type="text" class="w-full mb-3 px-4 py-2 border border-white/20 bg-white/10 text-white placeholder-gray-300 rounded-xl focus:outline-none"/>
      <button onclick="createAdminPanel()" class="w-full bg-indigo-600 py-2 rounded-xl hover:bg-indigo-700 text-white">Create Admin</button>
      <div id="adminPanelResult" class="text-green-400 mt-3 text-center hidden"></div>
      <div id="adminPanelError" class="text-red-400 mt-3 text-center hidden"></div>
      <button onclick="closeAdminPanel()" class="w-full mt-4 text-gray-400 hover:text-white">Close</button>
    </div>
  </div>

  <!-- Panel Modal -->
  <div id="panelModal" class="fixed inset-0 bg-black bg-opacity-80 z-50 flex items-center justify-center hidden">
    <div class="bg-gray-900 p-6 rounded-lg shadow-lg w-full max-w-sm border border-white/10">
      <h2 class="text-2xl font-semibold text-center text-indigo-400 mb-4">Create Your Panel</h2>
      <input id="username" placeholder="Username" type="text" class="w-full mb-3 px-4 py-2 border border-white/20 bg-white/10 text-white placeholder-gray-300 rounded-xl focus:outline-none"/>
      <select id="plan" class="w-full mb-3 px-4 py-2 border border-white/20 bg-white/10 text-white placeholder-gray-300 rounded-xl focus:outline-none">
        <option disabled selected>Select a plan</option>
        <option value="1gb-v2">1GB - 40% CPU - 1GB Disk</option>
        <option value="2gb-v2">2GB - 60% CPU - 1GB Disk</option>
        <option value="3gb-v2">3GB - 80% CPU - 2GB Disk</option>
        <option value="4gb-v2">4GB - 100% CPU - 2GB Disk</option>
        <option value="5gb-v2">5GB - 120% CPU - 3GB Disk</option>
        <option value="6gb-v2">6GB - 140% CPU - 3GB Disk</option>
        <option value="7gb-v2">7GB - 160% CPU - 4GB Disk</option>
        <option value="8gb-v2">8GB - 180% CPU - 4GB Disk</option>
        <option value="9gb-v2">9GB - 200% CPU - 5GB Disk</option>
        <option value="10gb-v2">10GB - 220% CPU - 5GB Disk</option>
        <option value="unlimited-v2">Unlimited - Unlimited CPU & Disk</option>
      </select>
      <button onclick="submitPanelForm()" class="w-full bg-indigo-600 text-black font-semibold py-3 rounded-xl hover:bg-indigo-700 transition">Create Panel</button>
      <div id="panelResult" class="mt-8 p-4 bg-green-900 border border-green-300 rounded-md hidden whitespace-pre-wrap font-mono text-sm"></div>
      <div id="panelError" class="mt-8 p-4 bg-red-900 border border-red-300 rounded-md hidden text-red-400 font-semibold"></div>
      <button onclick="closePanel()" class="w-full mt-4 text-gray-400 hover:text-white">Close</button>
    </div>
  </div>

<script>
  function togglePassword() {
    var passInput = document.getElementById("loginPass");
    passInput.type = passInput.type === "password" ? "text" : "password";
  }
  function doLogin() {
    const u=document.getElementById("loginUser").value, p=document.getElementById("loginPass").value;
    if(u==="admin" && p==="kimganz"){
      document.getElementById("loginOverlay").style.display="none";
      document.getElementById("dashboardMenu").classList.remove("hidden");
    } else document.getElementById("loginError").classList.remove("hidden");
  }
  function showAdminPanel(){document.getElementById("adminPanelModal").classList.remove("hidden")}
  function closeAdminPanel(){document.getElementById("adminPanelModal").classList.add("hidden")}
  function showPanel(){document.getElementById("panelModal").classList.remove("hidden")}
  function closePanel(){document.getElementById("panelModal").classList.add("hidden")}

  async function createAdminPanel(){
    const nameInput=document.getElementById("adminNameInput").value.trim();
    const resDiv=document.getElementById("adminPanelResult"), errDiv=document.getElementById("adminPanelError");
    resDiv.classList.add("hidden"); errDiv.classList.add("hidden");
    if(!nameInput){ errDiv.textContent="Nama admin tidak boleh kosong."; errDiv.classList.remove("hidden"); return; }
    try{
      const res=await fetch("/api/create-admin",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:nameInput})});
      const d=await res.json();
      if(res.ok){ resDiv.innerHTML=`‚úÖ Admin Created!<br>Email: <b>${d.email}</b><br>Username: <b>${d.username}</b><br>Password: <b>${d.password}</b>`;resDiv.classList.remove("hidden");}
      else{ errDiv.textContent=d.error||"Gagal membuat admin."; errDiv.classList.remove("hidden"); }
    }catch(e){errDiv.textContent="Network error!";errDiv.classList.remove("hidden")}
  }

  const planSpecs={"1gb-v2":{ram:"1000",disk:"1000",cpu:"40"},"2gb-v2":{ram:"2000",disk:"1000",cpu:"60"},"3gb-v2":{ram:"3000",disk:"2000",cpu:"80"},"4gb-v2":{ram:"4000",disk:"2000",cpu:"100"},"5gb-v2":{ram:"5000",disk:"3000",cpu:"120"},"6gb-v2":{ram:"6000",disk:"3000",cpu:"140"},"7gb-v2":{ram:"7000",disk:"4000",cpu:"160"},"8gb-v2":{ram:"8000",disk:"4000",cpu:"180"},"9gb-v2":{ram:"9000",disk:"5000",cpu:"200"},"10gb-v2":{ram:"10000",disk:"5000",cpu:"220"},"unlimited-v2":{ram:"0",disk:"0",cpu:"0"}};
  async function submitPanelForm(){
    const user=document.getElementById("username").value.trim(), plan=document.getElementById("plan").value;
    const resDiv=document.getElementById("panelResult"), errDiv=document.getElementById("panelError");
    resDiv.classList.add("hidden"); errDiv.classList.add("hidden");
    if(!user){ errDiv.textContent="Please enter a username."; errDiv.classList.remove("hidden"); return; }
    if(!planSpecs[plan]){ errDiv.textContent="Please select a valid plan."; errDiv.classList.remove("hidden"); return; }
    resDiv.textContent="Creating user and server panel, please wait..."; resDiv.classList.remove("hidden");
    try{
      const specs=planSpecs[plan];
      const response=await fetch("/api/create-panel",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:user,plan,ram:specs.ram,disk:specs.disk,cpu:specs.cpu})});
      const data=await response.json();
      if(response.ok){
        resDiv.innerHTML=`‚úÖ Panel Created Successfully!<br>üë§ Username: ${data.username||'N/A'}<br>üîê Password: ${data.password||'N/A'}<br>- RAM: ${specs.ram==="0"?"Unlimited":specs.ram.charAt(0)+"GB"}<br>- Disk: ${specs.disk==="0"?"Unlimited":specs.disk.charAt(0)+"GB"}<br>- CPU: ${specs.cpu==="0"?"Unlimited":specs.cpu+"%"}`;}
      else{ throw new Error(data.error||"Unknown error");}
    }catch(err){
      errDiv.textContent="Error: "+err.message; errDiv.classList.remove("hidden"); resDiv.classList.add("hidden");
    }
  }
</script>
</body>
</html>
